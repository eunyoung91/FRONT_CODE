<!-- ğŸ”¸ AdminGuide.vue: ê°€ì´ë“œ í˜ì´ì§€ ì „ì²´ë¥¼ êµ¬ì„±í•˜ëŠ” ë©”ì¸ ë·° ì»´í¬ë„ŒíŠ¸ -->

<template>
    <div class="admin-container">
        <AdminSidebar :menu-data="menuData" />

        <div class="admin-content">
            <AdminHeader
            :userName="userName"
            :userRole="userRole"
            :loginTime="loginTime"
            />

            <div class="main-content">

                <h1>íƒ€ì´í‹€ ì˜ì—­</h1>

                <div class="title-menu">
                    <!-- ì™¼ìª½ ì˜ì—­ -->
                    <div class="title-main">
                        <img src="https://campus.megastudy.net/admin/image/dot_icon03.png" alt="ì•„ì´ì½˜">
                        <span>í•´ë‹¹ ë©”ë‰´ëª…ì´ ë“¤ì–´ê°€ìš”</span>
                    </div>
                    <!-- ì˜¤ë¥¸ìª½ ì˜ì—­ -->

                </div>

                <div class="title-sub">
                    <img src="https://campus.megastudy.net/admin/image/dot_icon04.png" alt="ì•„ì´ì½˜">
                    <span>í•´ë‹¹ ì„œë¸Œ ë©”ë‰´ëª…ì´ ë“¤ì–´ê°€ìš”</span>
                </div>

                
                <h1>ë²„íŠ¼ ì˜ì—­ @/components/guide/CommonButton.vue</h1>
                
                <h2>ğŸŸ£ ê¸°ë³¸ / active</h2>
                
                <div class="btn-box">
                    <CommonButton size="large">ë²„íŠ¼ (Primary, large)</CommonButton>
                    <CommonButton variant="secondary" size="large">ë²„íŠ¼ (secondary, large)</CommonButton>
                    <CommonButton variant="danger" size="large">ë²„íŠ¼ (danger, large)</CommonButton>
                    <CommonButton variant="outline" size="large">ë²„íŠ¼ (outline, large)</CommonButton>
                </div>
                <div class="btn-box">
                    <CommonButton>ë²„íŠ¼ (Primary, Medium)</CommonButton>
                    <CommonButton variant="secondary">ë²„íŠ¼ (secondary, Medium)</CommonButton>
                    <CommonButton variant="danger">ë²„íŠ¼ (danger, Medium)</CommonButton>
                    <CommonButton variant="outline">ë²„íŠ¼ (outline, Medium)</CommonButton>
                </div>
                <div class="btn-box">
                    <CommonButton size="small">ë²„íŠ¼ (Primary, small)</CommonButton>
                    <CommonButton variant="secondary" size="small">ë²„íŠ¼ (secondary, small)</CommonButton>
                    <CommonButton variant="danger" size="small">ë²„íŠ¼ (danger, small)</CommonButton>
                    <CommonButton variant="outline" size="small">ë²„íŠ¼ (outline, small)</CommonButton>
                </div>

                <h2>ğŸŸ£ disabled</h2>
                <div class="btn-box">
                    <CommonButton :disabled="true">ë²„íŠ¼ (Primary, Medium, disabled)</CommonButton>
                    <CommonButton variant="secondary" :disabled="true">ë²„íŠ¼ (secondary, Medium, disabled)</CommonButton>
                    <CommonButton variant="danger" :disabled="true">ë²„íŠ¼ (danger, Medium, disabled)</CommonButton>
                    <CommonButton variant="outline" :disabled="true">ë²„íŠ¼ (outline, Medium, disabled)</CommonButton>
                </div>

                <h2>ğŸŸ£ icon</h2>
                <div class="btn-box">
                    <CommonButton variant="secondary" size="small" iconPosition="right">
                        ë‹¤ìš´ë¡œë“œ
                        <template #icon>
                            <i class="fas fa-file"></i>
                        </template>
                    </CommonButton>

                    <CommonButton variant="secondary" size="small" iconPosition="right">
                        ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
                        <template #icon>
                            <i class="fas fa-file-excel"></i>
                        </template>
                    </CommonButton>

                    <CommonButton variant="danger" size="medium">
                        <template #icon>
                            <i class="fas fa-trash-alt"></i>
                        </template>
                        ì‚­ì œí•˜ê¸°
                    </CommonButton>

                    <CommonButton variant="danger" iconPosition="right">
                        ê²½ê³  ë©”ì‹œì§€
                        <template #icon>
                            <i class="fas fa-exclamation-triangle"></i>
                        </template>
                    </CommonButton>

                    <CommonButton variant="outline" iconPosition="right">
                        ë‹¤ìŒ ë‹¨ê³„
                        <template #icon>
                            <i class="fas fa-arrow-right"></i>
                        </template>
                    </CommonButton>

                    <CommonButton variant="secondary" size="small">
                        <template #icon>
                            <i class="fas fa-cog"></i>
                        </template>
                    </CommonButton>
                </div>

                <h2>ğŸŸ£ ex</h2>
                <div class="btn-box">
                </div>

                <h1>ë ˆì´ì–´ íŒì—…</h1>
                <div class="btn-box">
                    <CommonButton variant="secondary" @click.prevent="showPopup('popup1')">
                        íŒì—… 1 ì—´ê¸°
                    </CommonButton>
                    
                    <CommonButton variant="secondary" @click.prevent="showPopup('popup2')">
                        íŒì—… 2 ì—´ê¸°
                    </CommonButton>
                </div> 

                <PopupLayer
                    :visible="popups.popup1"
                    title="íŒì—… ì œëª©ì´ ë“¤ì–´ê°€ìš”1"
                    @close="hidePopup('popup1')"
                >
                    <p>íŒì—… 1ì˜ ë‚´ìš©ì…ë‹ˆë‹¤.íŒì—… 1ì˜ ë‚´ìš©ì…ë‹ˆë‹¤.íŒì—… 1ì˜ ë‚´ìš©ì…ë‹ˆë‹¤.íŒì—… 1ì˜ ë‚´ìš©ì…ë‹ˆë‹¤.
                        íŒì—… 1ì˜ ë‚´ìš©ì…ë‹ˆë‹¤.íŒì—… 1ì˜ ë‚´ìš©ì…ë‹ˆë‹¤.íŒì—… 1ì˜ ë‚´ìš©ì…ë‹ˆë‹¤.
                    </p>
                </PopupLayer>

                <PopupLayer
                    :visible="popups.popup2"
                    title="íŒì—… ì œëª©ì´ ë“¤ì–´ê°€ìš”2"
                    @close="hidePopup('popup2')"
                >
                    <p>ì´ê³³ì€ ë‘ ë²ˆì§¸ íŒì—… ë‚´ìš©ì…ë‹ˆë‹¤.</p>
                </PopupLayer>

                <h1>í˜ì´ì§• ì˜ì—­</h1>
                <BasePagination
                    :current-page="currentPage"
                    :page-numbers="visiblePages"
                    :has-previous-page-set="hasPrev"
                    :has-next-page-set="hasNext"
                    :previous-page-set-end="prevSetEnd"
                    :next-page-set-start="nextSetStart"
                    @page-changed="handlePageChange"
                />
            </div>
        </div>
    </div>
</template>

<script>
import AdminSidebar from '@/views/guide/AdminSidebar.vue'
import AdminHeader from '@/views/guide/AdminHeader.vue'

import CommonButton from '@/components/guide/CommonButton.vue';
import PopupLayer from '@/components/guide/PopupLayer.vue';
import BasePagination from "@/components/guide/BasePagination.vue";

export default {
    name: "AdminGuide",
    components: {
        AdminSidebar,
        AdminHeader,
        CommonButton,
        PopupLayer,
        BasePagination 
    },
    props: {
        userName: {
            type: String,
            // required: true,
            default: 'ë°•ì€ì˜'
        },
        userRole: {
            type: String,
            default: 'ê´€ë¦¬ì'
        },
        loginTime: {
            type: String,
            // required: true,
            default: function () {
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                return `${year}-${month}-${day} ${hours}:${minutes}`;
            }
        },

        type: {
            type: String,
            default: 'button'
        },
        variant: {
            type: String,
            default: 'primary' // primary, secondary, danger, outline
        },
        size: {
            type: String,
            default: 'medium' // small, medium, large
        },
        customClass: {
            type: String,
            default: ''
        },
        disabled: {
            type: Boolean,
            default: false
        },
        iconPosition: {
            type: String,
            default: 'left',
            validator: value => ['left', 'right'].includes(value)
        },
    },
    data() {
        return {
            isFixed: false,
            menuData: [],
            popups: {
                popup1: false,
                popup2: false
            },
            campusList: [
                [
                    {
                        name: 'INTRO',
                        code: 'INTRO',
                        detail: 'INTRO',
                        isCurrent: true,
                        isIntro: true
                    }
                ],
                [
                    { name: 'ê°•ë‚¨ ì¬ìˆ˜í•™ì›', code: 'CD0001', detail: 'CD0206' },
                    { name: 'ì„œì´ˆ ì¬ìˆ˜í•™ì›', code: 'CD0004', detail: 'CD0208' },
                    { name: 'ê°•ë¶ ì¬ìˆ˜í•™ì›', code: 'CD0005', detail: 'CD0210' },
                    { name: 'ë…¸ëŸ‰ì§„ ì¬ìˆ˜í•™ì›', code: 'CD0006', detail: 'CD0211' },
                    { name: 'ì‹ ì´Œ ì¬ìˆ˜í•™ì›', code: 'CD0036', detail: 'CD0213' },
                    { name: 'ì†¡íŒŒ ì¬ìˆ˜í•™ì›', code: 'CD0275', detail: 'CD0276' },
                    { name: 'ë¶€ì²œ ì¬ìˆ˜í•™ì›', code: 'CD0250', detail: 'CD0251' },
                    { name: 'ë¶„ë‹¹ ì¬ìˆ˜í•™ì›', code: 'CD0252', detail: 'CD0253' },
                    { name: 'ì¼ì‚° ì¬ìˆ˜í•™ì›', code: 'CD0254', detail: 'CD0255' },
                    { name: 'í‰ì´Œ ì¬ìˆ˜í•™ì›', code: 'CD0179', detail: 'CD0217' },
                    { name: 'ìµœìƒìœ„ê¶Œ ì „ë¬¸ê´€', code: 'CD0178', detail: 'CD0220' },
                    { name: 'ìì—°ê³„ ì „ë¬¸ê´€', code: 'CD0039', detail: 'CD0243' },
                    { name: 'ì•ˆì„± ê¸°ìˆ™í•™ì›', code: 'CD0279', detail: 'CD0280' }
                ],
                [
                    { name: 'ì„±ë¶ ì¬í•™í•™ì›', code: 'CD0098', detail: 'CD0214' },
                    { name: 'í…ŒìŠ¤íŠ¸ í•™ì›', code: 'CD0277', detail: 'CD0278' }
                ]
            ],
            // ğŸ” SearchAreaìš© í¼ ë°ì´í„° ì¶”ê°€
            form: {
                kind: '',
                ccode: '',
                ccode2: '',
                search_mode: '',
                keyfield: 'mn_name',
                keyword: '',
                sdate: '',
                edate: ''
            },
            // success: {
            //     total: 1740,
            //     inTime: 1739,
            //     outOfTime: 1
            // },
            // failure: 196,
            // tabList: [
            //     { label: 'ì „ì²´(46)', url: 'admin_list.asp', active: true },
            //     { label: 'ëŒ€ê¸°(3)', url: 'admin_list.asp?mode=N', active: false },
            //     { label: 'ì™„ë£Œ(43)', url: 'admin_list.asp?mode=Y', active: false }
            // ],
            // selectedCampus: '',
            // selectedMenu: '',

            // menuList: ['ë©”ë‰´1', 'ë©”ë‰´2', 'ë©”ë‰´3'], // í•„ìš” ì‹œ API ì—°ë™ ë˜ëŠ” ìˆ˜ë™ì…ë ¥

            // paging
            currentPage: 1,
            allPages: Array.from({ length: 100 }, (_, i) => i + 1),
            pageSize: 10,

            //button

        };
    },
    created() {
        const menus = [
            { seqGroup: 1, menuName1: "ë©”ë‰´ëª…1", menuName2: "ì„œë¸Œë©”ë‰´ëª…1-1", link: "/admin/menu1_1" },
            { seqGroup: 1, menuName1: "ë©”ë‰´ëª…1-2", menuName2: "ì„œë¸Œë©”ë‰´ëª…1-2", link: "/admin/menu1_2" },
            { seqGroup: 2, menuName1: "ë©”ë‰´ëª…2", menuName2: "ì„œë¸Œë©”ë‰´ëª…2-1", link: "/admin/menu2_1" },
            { seqGroup: 2, menuName1: "ë©”ë‰´ëª…2-2", menuName2: "ì„œë¸Œë©”ë‰´ëª…2-2", link: "/admin/menu2_2" },
        ];
        this.menuData = this.convertMenuData(menus);
    },

    computed: {

        // button
        variantClass() {
            return `btn-${this.variant}`;
        },
        sizeClass() {
            return `btn-size-${this.size}`;
        },

		activeClass() {
			return {
				'is-active': this.isActive
			};
		},

        // paging
        visiblePages() {
            const start = Math.floor((this.currentPage - 1) / this.pageSize) * this.pageSize;
            return this.allPages.slice(start, start + this.pageSize);
        },
        hasPrev() {
            return this.currentPage > this.pageSize;
        },
        hasNext() {
            return this.currentPage <= this.allPages.length - this.pageSize;
        },
        prevSetEnd() {
            return Math.max(this.currentPage - this.pageSize, 1);
        },
        nextSetStart() {
            return this.currentPage + this.pageSize;
        },


    },

    methods: {
        // button
		toggleActive() {
			this.isActive = !this.isActive;
		},

        showPopup(popupKey) {
            this.popups[popupKey] = true;
            document.body.style.overflow = 'hidden';
        },
        hidePopup(popupKey) {
            this.popups[popupKey] = false;
            if (!Object.values(this.popups).includes(true)) {
                document.body.style.overflow = '';
            }
        },
        convertMenuData(menus) {
            const groupedMenus = {};
            menus.forEach((menu) => {
                if (!groupedMenus[menu.seqGroup]) {
                    groupedMenus[menu.seqGroup] = {
                        id: menu.seqGroup,
                        title: menu.menuName1,
                        link: menu.link,
                        subMenu: [],
                    };
                }
                groupedMenus[menu.seqGroup].subMenu.push({
                    id: `${menu.seqGroup}-${menu.menuName2}`,
                    title: menu.menuName2,
                    link: menu.link,
                    code: `code-${menu.menuName2}`,
                });
            });
            return Object.values(groupedMenus);
        },

        // ğŸ” SearchArea
        resetForm: function () {
            this.form = {
                kind: '',
                ccode: '',
                ccode2: '',
                search_mode: '',
                keyfield: 'mn_name',
                keyword: '',
                sdate: '',
                edate: ''
            };
        },
        setDateRange: function (type, offset) {
            const today = new Date();
            let start = new Date();

            if (type === 'ww') start.setDate(today.getDate() + 7 * offset);
            else if (type === 'm') start.setMonth(today.getMonth() + offset);

            const formatDate = (date) =>
                date.toISOString().split('T')[0];

            this.form.sdate = formatDate(start);
            this.form.edate = formatDate(today);
        },

        handlePageChange(page) {
            this.currentPage = page;
        },
    }
};
</script>

<style lang="scss" scoped>
    h1{
        font-size:14px;
        color:#333;
        margin:30px 0 10px;
        padding:10px;
        background:rgba(82, 82, 82, 0.1);
    }
    h2{
        font-size:12px;
        color:#444;
        margin:15px 0 10px;
        padding:5px;
        background:rgba(145, 10, 255, 0.1);
    }

</style>