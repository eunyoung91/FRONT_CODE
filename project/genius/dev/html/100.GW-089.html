<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<title>에듀윌 그룹웨어(Genius)</title>

<!-- favicon files -->
<link rel="Bookmark Icon" href="//img.eduwill.net/Img2/Common/favicon/favicon.ico" />
<link rel="icon" href="//img.eduwill.net/Img2/Common/favicon/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="//img.eduwill.net/Img2/Common/favicon/favicon.ico" type="image/x-icon" />

<!-- css files -->
<!-- layout css -->
<link rel="stylesheet" href="https://img.eduwill.net/resources/kpi/dev/plugins/bootstrap/css/bootstrap.min.css" />
<link rel="stylesheet" href="https://img.eduwill.net/resources/kpi/dev/css/essentials.css" />
<link rel="stylesheet" href="css/genius.css" />


<!-- javascript files -->
<script type="text/javascript">var plugin_path = '//img.eduwill.net/resources/kpi/live/plugins/';</script>
<script src="//img.eduwill.net/resources/kpi/live/plugins/jquery/jquery-2.2.3.min.js" type="text/javascript"></script>
<script src="//img.eduwill.net/resources/kpi/live/plugins/jquery/jquery-ui-1.12.1.min.js" type="text/javascript"></script>
<script src="//img.eduwill.net/resources/kpi/live/js/jquery.easyui.min.js" type="text/javascript" ></script>
<script src="//img.eduwill.net/resources/kpi/live/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<script src="//img.eduwill.net/resources/kpi/live/plugins/bootstrap.datepicker/js/bootstrap-datepicker.min.js"></script>
<script src="//img.eduwill.net/resources/kpi/live/js/ajaxUtil.js" type="text/javascript"></script>

<!-- validation -->
<script src="//img.eduwill.net/resources/kpi/live/plugins/form.validate/jquery.form.min.js" type="text/javascript"></script>
<script src="//img.eduwill.net/resources/kpi/live/plugins/form.validate/jquery.validation.min.js" type="text/javascript"></script>

<script src="//img.eduwill.net/resources/kpi/live/js/custom.js?v=5a2d148c09b00" type="text/javascript"></script>
<script src="//img.eduwill.net/resources/kpi/live/js/common.js?v=5ad59eb6c6f40" type="text/javascript"></script>

<!-- 토스트메시지 -->
<link href="//img.eduwill.net/resources/kpi/live/plugins/toastr/toastr.min.css" rel="stylesheet" type="text/css" />
<script src="//img.eduwill.net/resources/kpi/live/plugins/toastr/toastr.min.js" type="text/javascript"></script>

<!-- 컨펌모달 -->
<link rel="stylesheet" href="//img.eduwill.net/resources/kpi/live/plugins/jquery-confirm/jquery-confirm.min.css">
<script src="//img.eduwill.net/resources/kpi/live/plugins/jquery-confirm/jquery-confirm.min.js"></script>

<!-- print -->
<script type="text/javascript" src="//img.eduwill.net/resources/kpi/live/plugins/printThis/printThis.js"></script>

<!-- editable -->
<script type="text/javascript" src="//img.eduwill.net/resources/kpi/live/plugins/bootstrap-editable.min.js"></script>

<!-- Fullcalendar -->
<link rel="stylesheet" href="//img.eduwill.net/resources/kpi/live/plugins/fullcalendar/fullcalendar.min.css" />
<link rel="stylesheet" href="//img.eduwill.net/resources/kpi/live/plugins/fullcalendar/fullcalendar.print.css" media="print" />
<script src="//img.eduwill.net/resources/kpi/live/plugins/moment.min.js" type="text/javascript"></script>
<script src="//img.eduwill.net/resources/kpi/live/plugins/fullcalendar/fullcalendar.min.js" type="text/javascript"></script>
<script src="//img.eduwill.net/resources/kpi/live/plugins/fullcalendar/lang-all.js" type="text/javascript"></script>
<script src="//img.eduwill.net/resources/kpi/live/plugins/fullcalendar/gcal.js" type="text/javascript"></script>

<!-- CKEditor -->
<script src="//img.eduwill.net/resources/kpi/live/plugins/ckeditor/ckeditor_4.10.0_full/ckeditor.js"></script>
<script src="//img.eduwill.net/resources/kpi/live/plugins/ckeditor/ckeditor_4.10.0_full/adapters/jquery.js"></script>

<script type="text/javascript">
	function pagePrint(){
		$('#pagePrint').printThis();
	}

	$(document).ready(function() {
		/** Bootstrap Tooltip **/ 
		$("[data-toggle=tooltip]").tooltip();
	})

</script>

</head>

<body class="body-sub body-genius">

<!-- wrapper -->
<div id="wrapper" class="clearfix">

	<!-- hd-wrap -->
    <section class="hd-wrap">
        <div class="hd-wrap-inner">
            <div class="logo">
                <a href="">지니어스</a>
            </div>
            <div class="gnb">
                <ul>
                    <li><a href="">전자결재</a></li>
                    <li><a href="">전사공지</a></li>
                    <li><a href="">업무요청</a></li>
                    <li><a href="">인사관리</a></li>
                    <li><a href="">지원관리</a></li>
                </ul>
            </div>
            <div class="comp-right">
                
                <div class="logout">
                    <button class="btn btn-g-link">로그아웃</button>
                </div>
                <div class="state">
                    <span onclick="$(this).next('.menu-tootip').fadeIn(100);"><i class="state-1"></i> 근무중</span>
                    <!--
                    <span><i class="state-2"></i> 자리비움</span>
                    <span><i class="state-3"></i> 로그오프</span>
                    -->
                    <div class="menu-tootip" style="display: none;" onclick="$(this).fadeOut(100);">
                        <div class="menu-tootip-inner">
                            <div class="link"><a href="#"><i class="state-1"></i> 근무중</a></div>
                            <div class="link"><a href="#"><i class="state-2"></i> 자리비움</a></div>
                            <div class="link"><a href="#"><i class="state-3"></i> 로그오프</a></div>
                        </div>
                    </div>
                </div> 
                <div class="organization">
                    <span><button class="btn btn-g-link btn-setting">관리자</button></span>
                    <span><button class="btn btn-g-link btn-person">조직도</button></span>
                </div>               
            </div>
        </div>
    </section>
    <div class="hd-wrap-expand" style="display: none;">
        <div class="hd-wrap-expand-inner">
            <div class="link">
                <a herf="">결재문서 작성</a>
                <a herf="">결재하기</a>
                <a herf="">수신함</a>
                <a herf="">매출/예산 계획 제출</a>
            </div>
            <div class="link">
                <a herf="">공지사항</a>
                <a herf="">에듀윌러 소식</a>
                <a herf="">에듀윌 스타</a>
                <a herf="">꿈의 직장</a>
            </div>
            <div class="link">
                <a herf="">마케팅</a>
                <a herf="">총무</a>
                <a herf="">IT</a>
                <a herf="">법무</a>
            </div>
            <div class="link">
                <a herf="">인사정보</a>
                <a herf="">평가</a>
                <a herf="">교육</a>
                <a herf="">자주 묻는 질문</a>
            </div>
            <div class="link">
                <a herf="">힐링큐브</a>
                <a herf="">E-스퀘어</a>
                <a herf="">차량배차</a>
                <a herf="">마음,쉼</a>
            </div>
        </div>
    </div>
    <!-- // hd-wrap -->

	<!-- aside -->
	<aside id="aside">
		<div class="aside-loaction">
			<strong>전사공지</strong>
			<button class="btn-collapse">접기</button>
		</div>
		<nav id="sideNav">
			<ul class="nav nav-list d1">
				<li class="d1 el_primary menu-open active">
					<a href="javascript:;" class="d1">
						<i class="main-icon fa fa-gears"></i>
						<span>공지사항</span>
					</a>
					<ul class="d2"><!-- 2depth -->
						<li class="d2 active">
							<span>업적/역량</span>
							<ul class="d3"><!-- 3depth -->
								<li class="d3 active">
									<a href="javascript:;" class="d3">전체공지
										<!-- <span class="label label-number">8</span> -->
									</a>
								</li>
								<li class="d3">
									<a href="javascript:;" class="d3">평가목표 관리</a>
								</li>
							</ul><!-- // 3depth -->
						</li>
					</ul><!-- // 2depth -->
				</li>
				<li class="d1 el_primary">
					<a href="javascript:;" class="d1">
						<i class="main-icon fa fa-balance-scale"></i>
						<span>에듀윌러 소식</span>
					</a>
					<ul class="d2"><!-- 2depth -->
						<li class="d2">
							<a href="javascript:;" class="d2">depth2</a>
						</li>
						<li class="d2">
							<a href="javascript:;" class="d2">depth2</a>
						</li>
					</ul>
				</li>
				<li class="d1 el_primary">
					<a href="javascript:;" class="d1">
						<i class="main-icon fa fa-pencil-square-o"></i>
						<span>에듀윌 스타</span>
					</a>
					<ul class="d2"><!-- 2depth -->
						<li class="d2">
							<a href="javascript:;" class="d2">depth2</a>
						</li>
						<li class="d2">
							<a href="javascript:;" class="d2">depth2</a>
						</li>
					</ul>
				</li>
				<li class="d1">
					<a href="javascript:;" class="d1">
						<i class="main-icon fa fa-table"></i>
						<span>꿈의직장</span></span>
					</a>
				</li>
			</ul>
		</nav>
	</aside>
	<div id="expand-wrap" style="display: none;">
		<button class="btn-expand">열기</button>
	</div>
	<!-- // aside -->

	<!-- middle -->		
	<section id="middle">
		<!-- Import viewbox -->
		<link rel="stylesheet" href="https://img.eduwill.net/resources/kpi/dev/plugins/jquery-viewbox/viewbox.css">
		<script type="text/javascript" src="https://img.eduwill.net/resources/kpi/dev/plugins/jquery-viewbox/jquery.viewbox.min.js"></script>
		
		<div id="content" class="padding-20"><!-- content -->
			<div class="container section-search-form section-search-form-bg">
				<div class="middle-location">
					<a href="/" class="home">홈</a>
					<a href="#">교육</a>
					<a href="#">독서경영</a>
					<a href="#">독서모임</a>
					<a href="#">독서모임 신청하기</a>					
				</div>
			</div>
			
			<div class="container section-search-form alert alert-info"><!-- section-search-form -->
			</div>
			
			<div class="container section-leave padding-left-0"><!-- section-objective -->
				<form id="frmWrite" name="frmWrite" method="post" onsubmit="return false;" novalidate="novalidate">
					<input type="hidden" id="apprv_idx" name="apprv_idx" value="">
					<input type="hidden" id="status_cd" name="status_cd" value="SC002"><!-- 대기 -->
					<input type="hidden" id="docCd" name="docCd" value="SC018">
					<input type="hidden" id="title" name="title" value="독서모임 신청 및 도서구입 결의서">
					<input type="hidden" id="loginId" name="loginId" value="hkkim5">
					<input type="hidden" id="profiles_active" value="dev">
					
					<div class="panel-body">
						<div class="padding-20 text-center">
							<h3>독서모임 신청 및 도서구입 결의서</h3>
						</div>
					
						<div class="table-responsive table-basic"><!-- table-basic -->
							<table class="table table-bordered table-row margin-bottom-20">
								<caption>기본정보</caption>
								<colgroup>
									<col width="14%">
									<col width="22%">
									<col width="14%">
									<col width="16%">
									<col width="14%">
									<col width="16%">
								</colgroup>
								<tbody>
									<tr>
										<th>문서구분</th>
										<td class="text-center"><strong>독서모임 신청 및 도서구입 결의서</strong></td>
										<th>문서번호</th>
										
										
											
											
												<td class="text-left" colspan="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
											
										
									</tr>
									<tr>
										<th>소속</th>
										<td class="text-center">플랫폼개발2팀</td>
										<th>작성자</th>
										<td class="text-center">김현경&nbsp;매니저</td>
										<th>작성일시</th>
										<td class="text-center">2021-03-12</td>
									</tr>
								</tbody>
							</table>
						</div>
						
						<h4 class="bul-1 margin-top-0" id="hApproval">결재라인 <span class="padding-left-0"><br>※ 조장의 결재라인(해당 부서장) 기준<br>※ 도서구입비 10만원 미만: 본부장/실장/원장 전결, 10만원 이상: 대표이사 전결</span></h4>
						<div class="board-1 clearfix" id="divApproval">
							<ul id="ulApproval">
							<li>
								<input type="hidden" id="ldap_id" value="hkkim5"> 
								<input type="hidden" id="chrgCd" value="SC001">
								<div class="field-1">작성자</div>
								<div class="field-2">플랫폼개발2팀</div>
								<div class="field-3">김현경</div>
								<div class="field-4">매니저</div>
							</li></ul>
							<ul class="clearfix ui-sortable" id="ulSort">
							<li>
										<div class="field-1">
											<select class="form-control" id="chrgCd" name="chrgCd">
												<option value="SC002">결재자</option>
												<option value="SC003" selected="">합의자</option>
												<option value="SC004">승인자</option>
											</select>
											<a class="remove-a"><i class="fa fa-close"></i></a>
											<input type="hidden" name="ldap_id" id="ldap_id" value="jwchoi">
										</div>
										<div class="field-2">인재육성팀</div>
										<div class="field-3">최정원</div>
										<div class="field-4">매니저</div>
									</li></ul>
							<a href="#" class="btn btn-3d btn-teal" id="btnAddForApprv" data-toggle="modal" data-target="#sapprovalLine1"><i class="fa fa-plus"></i>결재자 추가</a>
						</div>
						
						<div class="text-right margin-top-20">
							<a href="#" class="btn btn-3d btn-sm btn-primary" id="btnAddForRecept" data-toggle="modal" data-target="#sapprovalLine2"><i class="fa fa-plus"></i>수신자 추가</a>
						</div>
						<div class="table-responsive table-basic margin-top-20"><!-- table-basic -->
							<table class="table table-bordered table-row">
								<caption>기본정보</caption>
								<colgroup>
									<col style="width: 200px">
									<col>
								</colgroup>
								<tbody>
									<tr><!-- row -->
										<th>수신자
											<span class="margin-bottom-10 tooltip-nowrap" data-toggle="tooltip" title="" data-original-title="결재가 승인되면 추가한 수신자의 수신함에 노출됩니다."> 
												<i class="fa fa-exclamation-circle"></i>
											</span>
										</th>
										<td>
											<div class="teamtxt" id="divReceive">
												<!-- 기본 수신자 정보를 넣어야 하는경우? 신규등록,  -->
												
													 
														<span><input type="hidden" id="receive_id" name="receive_id" value="17">재무팀</span>
													 
														<span><input type="hidden" id="receive_id" name="receive_id" value="mkkim4">김민규</span>
													 
														<span><input type="hidden" id="receive_id" name="receive_id" value="jwchoi">최정원</span>
													
												
											</div>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
						
						<div class="text-right margin-top-20">
							<a href="#" class="btn btn-3d btn-sm btn-primary" id="btnAddForRefer" data-toggle="modal" data-target="#sapprovalLine3"><i class="fa fa-plus"></i>참조자 추가</a>
						</div>
						
							<div class="table-responsive table-basic margin-top-20"><!-- table-basic -->
								<table class="table table-bordered table-row">
									<caption>기본정보</caption>
									<colgroup>
										<col style="width: 200px">
										<col>
									</colgroup>
									<tbody>
										<tr><!-- row -->
											<th>참조자
												<span class="margin-bottom-10 tooltip-nowrap" data-toggle="tooltip" title="" data-original-title="결재가 상신되면 추가한 참조자의 참조문서함에 노출됩니다."> 
													<i class="fa fa-exclamation-circle"></i>
												</span>
											</th>
											<td>
												<div class="teamtxt" id="divRefer">
													<!-- 기본 수신자 정보를 넣어야 하는경우? 신규등록,  -->
													
															
														
												</div>
											</td>
										</tr>
									</tbody>
								</table>
							</div>
						
						
						
						<h4 class="bul-1" id="docBtnArea">상세내용 </h4>
						<div id="docArea" class="table-responsive table-basic">
					<p class="margin-top-0 margin-bottom-3">※ 결재득 후, 해당문서는 재무팀 제출 후 도서구입(yes24 활용) 진행해 주시기 바랍니다.</p>
					<table class="table table-bordered table-row margin-bottom-20">
						<caption>기본정보</caption>
						<colgroup>
							<col width="15%">
							<col width="15%">
							<col width="25%">
							<col width="15%">
							<col width="23%">
						</colgroup>
						<tbody>
							<tr>
								<th colspan="5">독서모임 신청</th>
							</tr>
							<tr>
								<th>조장</th>
								<td colspan="4">
									<div class="row">
										<div class="col-xs-10" id="divGroupldr"><span>플랫폼개발2팀 김현경 매니저</span></div>
										<div class="col-xs-2 text-right">
											<input type="hidden" class="form-control full" id="grpldr_id" name="grpldr_id" value="hkkim5">
										</div>
									</div>
								</td>
							</tr>
							<tr>
								<th>조원  <span class="text-red">*</span></th>
								<td colspan="4">
									<div class="row">
										<div class="col-xs-10" id="divGroupemp"></div>
										<div class="col-xs-2 text-right">
											<a href="javascript:;" class="btn btn-3d btn-sm btn-primary" id="btnAddForBookmeet2"><i class="fa fa-plus"></i>조원 추가</a>
										</div>
									</div>
								</td>
							</tr>
							<tr>
								<th>모임명  <span class="text-red">*</span></th>
								<td colspan="4">
									<input type="text" class="form-control half required" id="meet_name" name="meet_name" placeholder="" autocomplete="off">
								</td>
							</tr>
							<tr>
								<th>활동기간  <span class="text-red">*</span></th>
								<td colspan="4">
									<select class="form-control half required" id="actmnth" name="actmnth">
										<option value="1">1개월</option>
										<option value="2">2개월</option>
									</select>
								</td>
							</tr>
							<tr>
								<th>활동계획 <span class="text-red">*</span></th>
								<td colspan="4">
									<textarea class="text form-control full height-full required" id="actplan" name="actplan" rows="3" value="" placeholder="ex) 1. 개인별 독서활동 (OO월 OO일까지)
		2. 독서모임 (OO월 OO일 11:50 ~ 13:00)
		3. 결과보고서 상신 및 마무리 (OO월 OO일)"></textarea>
								</td>
							</tr>
							<tr>
								<th rowspan="3">도서정보 <span class="text-red">*</span></th>
								<th>카테고리  <span class="text-red">*</span>
									<span class="margin-bottom-10 tooltip-nowrap" data-toggle="tooltip" title="" data-original-title="yes24에서 해당 도서 조회 시 해당하는 카테고리를 선택"> 
										<i class="fa fa-exclamation-circle"></i>
									</span>
								</th>
								<th>도서명  <span class="text-red">*</span></th>
								<th>저자명  <span class="text-red">*</span></th>
								<th>
									소개페이지 링크  <span class="text-red">*</span> 
									<span class="margin-bottom-10 tooltip-nowrap" data-toggle="tooltip" title="" data-original-title="yes24 URL을 입력해주세요."> 
										<i class="fa fa-exclamation-circle"></i>
									</span>
								</th>
							</tr>
							<tr>
								<td colspan="4" id="tdBookInfo">
									<div class="row bItem margin-bottom-10">
										<div class="margin-left-10 margin-right-10" style="width: 18% !important; display:inline-block;">
											<select class="form-control full required" id="ctgry_cd" name="ctgry_cd">
												<option value="">카테고리</option>
											<option value="SC001">가정/살림</option><option value="SC002">건강/취미</option><option value="SC003">경제/경영</option><option value="SC004">국어/외국어/사전</option><option value="SC005">사회/정치</option><option value="SC006">소설/시/희곡</option><option value="SC007">에세이</option><option value="SC008">여행</option><option value="SC009">역사</option><option value="SC010">예술</option><option value="SC011">인문</option><option value="SC012">인물</option><option value="SC013">자기계발</option><option value="SC014">자연과학</option><option value="SC015">종교</option><option value="SC016">IT 모바일</option><option value="SC017">교재/참고서</option><option value="SC018">기타</option></select>
										</div>
										<div class="" style="width: 30% !important; display:inline-block;">
											<input type="text" class="form-control full required" id="book_name" name="book_name" placeholder="도서명" autocomplete="off">
										</div>
										<div class="margin-left-10" style="width: 18% !important; display:inline-block;">
											<input type="text" class="form-control full required" id="book_authr" name="book_authr" placeholder="저자명" autocomplete="off">
										</div>
										<div class="text-right margin-right-10" style="width: 27% !important; display:inline-block;">
											<input type="text" class="form-control width-200 required" id="book_url" name="book_url" placeholder="소개페이지 링크" autocomplete="off">
											<button type="button" class="btn btn-primary btn-xs text-center btn-plus" id="btnPlus"><i class="fa fa-plus nopadding"><span class="sr-only">항목추가</span></i></button>
											<button type="button" class="btn btn-danger btn-xs text-center btn-minus" id="btnMinus" style="display: none;"><i class="fa fa-minus nopadding"><span class="sr-only">항목 제거</span></i></button>
										</div>
									</div>
								</td>
							</tr>
							<tr>
								<td colspan="4"><span class="text-default">※ 동일한 주제별 도서로 최대 3권까지 신청할 수 있습니다.(단, 카테고리 일치 및 1인 3만원 한도 내)</span></td>
							</tr>
							<tr>
								<th>기대효과  <span class="text-red">*</span></th>
								<td colspan="4">
									<textarea class="text form-control full height-full required" id="effect" name="effect" rows="3" value="" placeholder="ex1) 업무적용 인사이트 도출
		ex2) 직무역량 강화"></textarea>
								</td>
							</tr>
						</tbody>
					</table>
					<div class="">
						<span class="margin-right-10 size-15" style="font-weight: 600;">※ 도서구입 필요 여부</span>
						<label class="radio"><input type="radio" class="radio required margin-right-6" id="buy_yn_y" name="buy_yn" value="Y" checked=""><i></i> 필요</label>
						<label class="radio"><input type="radio" class="radio required margin-right-6" id="buy_yn_n" name="buy_yn" value="N"><i></i> 불필요</label>
					</div>
					<table class="table table-bordered table-row margin-bottom-20" id="tbBuy">
						<caption>기본정보</caption>
						<colgroup>
							<col width="15%">
							<col width="10%">
							<col width="20%">
							<col width="10%">
							<col width="25%">
						</colgroup>
						<tbody>
							<tr>
								<th colspan="5">도서구입 결의
									<span data-toggle="tooltip" title="" data-html="true" data-position="top" data-original-title="- 도서구입비 10만원 미만: 본부장/실장/원장 전결<br/>- 도서구입비 10만원 이상: 대표이사 전결<br/>- 1인 최대 3만원 한도">
										<i class="fa fa-exclamation-circle"></i>
									</span>
								</th>
							</tr>
							<tr>
								<th>결의신청일자</th>
								<td colspan="2">
									<input type="text" class="form-control datepicker full required" data-format="yyyy-mm-dd" data-lang="en" data-rtl="false" autocomplete="off" id="appdt" disabled="disabled">
									<input type="hidden" id="appdt1" name="appdt" value="2021-03-12">
								</td>
								<th>결제방법</th>
								<td>법인카드</td>
							</tr>
							<tr>
								<th>금액  <span class="text-red">*</span></th>
								<td colspan="2"><input type="text" class="form-control full required" id="amnt1" name="amnt1" placeholder="일금" autocomplete="off"></td>
								<td colspan="2"><input type="text" class="form-control full required" id="amnt2" name="amnt2" placeholder="￦" autocomplete="off"></td>
							</tr>
							<tr>
								<td colspan="5">
									<textarea class="text form-control full height-full" id="amnt_etc" name="amnt_etc" rows="3" value="" placeholder="*금액의 세부 내역을 입력해주세요. ex) 15,000원 * 3명 = 45,000원"></textarea>
								</td>
							</tr>
						</tbody>
					</table>
					<!-- 조원 모달 -->
					<div id="bookmeetEmp" class="modal fade modal-sapproval" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
						<div class="modal-dialog" style="width: 525px; margin-left: -320px;">
							<div class="modal-content">
					
								<!-- Modal Header -->
								<div class="modal-header">
									<h3 class="modal-title" id="myModalLabel">
										조장 추가
									</h3>
									<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
								</div>
					
								<!-- Modal Body -->
								<div class="modal-body">
									<div class="section-search-form padding-0 margin-bottom-20" style="float: right;">
										<input type="hidden" id="grpldryn" name="grpldryn" value="">
										
										<input type="text" class="form-control width-300 required" id="sValueForBookmeet" name="sValueForBookmeet" placeholder="이름을 입력해주세요." data-msg="이름을 입력해주세요." autocomplete="off">
										<button type="button" class="btn btn-teal" id="btnSearchForEmp">검색</button>
									</div>
					
									<div class="table-responsive table-objective margin-top-30" id="divGroupEmpList">
										<!-- from blankEmpList -->
									</div>
								</div>
					
								<!-- Modal Footer -->
								<div class="modal-footer clearfix">
									<button type="button" class="btn btn-teal btn-cancel" data-dismiss="modal">닫기</button>
								</div>
							</div>
						</div>
					</div>
				</div>
			
										
						<h4 class="bul-1">첨부파일</h4>
						<div class="padding-20 border border-silver bg-white" id="multipartArea">
							<div><a id="btnAddFile" class="btn btn-3d btn-teal"><i class="fa fa-plus"></i>파일첨부</a></div>
							<input type="file" id="input_imgs" name="input_imgs" style="display:none;" multiple="">
							<div class="non-img-file"></div>
							<div class="row file-gallery"></div>
						</div>
						
						
						<!-- 지출결의서에서만 노출 -->
						<h4 class="bul-1">결재문서 첨부</h4>
						<div class="padding-20 border border-silver bg-white">
							<div><a id="btnAddDoc" class="btn btn-3d btn-teal"><i class="fa fa-plus"></i>문서첨부</a></div>
							<div id="docDivArea">
								
							</div>
						</div>
						
						
						
						
						<div class="bottxt">상기와 같이 독서모임 신청 및 도서구입 결의서를 제출 합니다.</div>
						
						<!-- 문서 작성하기 영역 -->
						<div id="docMiddleArea" class="text-right margin-top-20">
						<button type="button" class="btn btn-sm width-120 btn-danger" id="btnList">작성취소</button>
						<button type="button" class="btn btn-sm width-120 btn-teal" id="btnSave">임시저장</button>	
						
					</div>
						
						
						<!-- 문서작성하기 영역 -->
						<div id="docBottomArea" class="text-center margin-top-20">
						<button type="button" class="btn btn-lg width-120 btn-primary" id="btnApply">결재요청</button>	
					</div>
						
						<!-- 결재 첨언 영역 -->
						
						
					<input type="hidden" name="dummy" value="go">
				
			</div></form><!-- // section-objective -->
			
			
		</div><!-- // content -->
		
		<div class="loading-dim-full" style="display:none;"><img src="http://img.eduwill.net/resources/common/web/images/loader/loading.gif" class="img-gif"></div>
		
		
		<!-- 수신자 선택용 -->
		<form id="frm2" name="frm2" method="post">
			<input type="hidden" id="receive_id" name="receive_id" value="">
			<input type="hidden" id="name" name="name" value="">
		</form>
		
		<!-- 목록 -->
		<form id="frmList" name="frmList" method="post" action="">
			<input type="hidden" id="fromdt" name="fromdt" value="">
			<input type="hidden" id="todt" name="todt" value="">
			<input type="hidden" id="status_cd" name="status_cd" value="">
			<input type="hidden" id="type_cd" name="type_cd" value="">
			<input type="hidden" id="title" name="title" value="">
		</form>
		
		<!-- 파일다운로드 -->
		<form name="frmFileDL" id="frmFileDL" method="post" action="">
			<input type="hidden" id="apprv_idx" name="apprv_idx" value="">
			<input type="hidden" id="seq" name="seq" value="">
		</form>
		
		
		<!-- Modal : sapprovalLine1 결재라인 불러오기 -->
		<div id="sapprovalLine1" class="modal fade modal-sapproval" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-dialog" style="width: 525px; margin-left: -320px;">
				<div class="modal-content">
		
					<!-- Modal Header -->
					<div class="modal-header">
						<h3 class="modal-title" id="myModalLabel">
							결재자 추가
						</h3>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
					</div>
		
					<!-- Modal Body -->
					<div class="modal-body">
						<div class="section-search-form padding-0 margin-bottom-20" style="float: right;">
							<form id="frmModal1" name="frmModal1" method="post" action="" novalidate="novalidate">
								<input type="text" class="form-control width-300 required" id="sValue" name="sValue" placeholder="이름을 입력해주세요." data-msg="이름을 입력해주세요." autocomplete="off">
								<button type="button" class="btn btn-teal" id="btnSearch">검색</button>
							</form>
						</div>
		
						<div class="table-responsive table-objective margin-top-30" id="divEmpList">
							<!-- from blankEmpList -->
						</div>
					</div>
		
					<!-- Modal Footer -->
					<div class="modal-footer clearfix">
						<button type="button" class="btn btn-teal btn-cancel" data-dismiss="modal">닫기</button>
					</div>
				</div>
			</div>
		</div>
		<!-- // Modal -->
		
		<!-- Modal : sapprovalLine2 수신자추가 -->
		<div id="sapprovalLine2" class="modal fade modal-sapproval" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-dialog" style="width: 525px; margin-left: -320px;">
				<div class="modal-content">
		
					<!-- Modal Header -->
					<div class="modal-header">
						<h3 class="modal-title" id="myModalLabel">
							수신자추가
						</h3>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
					</div>
		
					<!-- Modal Body -->
					<div class="modal-body">
						<div class="section-search-form padding-0 margin-bottom-20" style="float: right;">
							<form id="frmModal2" name="frmModal2" method="post" novalidate="novalidate">
								<select class="form-control" id="sKey" name="sKey">
									<option value="employee">개인</option>
									<option value="team">팀</option>
								</select>
								<input type="text" class="form-control half required" id="sValue" name="sValue" value="" placeholder="검색어를 입력하세요." autocomplete="off">
								<button type="button" class="btn btn-teal" id="btnSearch">검색</button>
							</form>
						</div>
		
						<div class="table-responsive table-objective margin-top-30" id="divEmpList2">
							<!-- from blankReceiveTargetList -->
						</div>
					</div>
		
					<!-- Modal Footer -->
					<div class="modal-footer clearfix">
						<button type="button" class="btn btn-teal btn-cancel" data-dismiss="modal">닫기</button>
					</div>
		
				</div>
			</div>
		</div>
		<!-- // Modal -->
		
		<!-- Modal : sapprovalLine3 수신자추가 -->
		<div id="sapprovalLine3" class="modal fade modal-sapproval" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-dialog" style="width: 525px; margin-left: -320px;">
				<div class="modal-content">
		
					<!-- Modal Header -->
					<div class="modal-header">
						<h3 class="modal-title" id="myModalLabel">
							참조자추가
						</h3>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
					</div>
		
					<!-- Modal Body -->
					<div class="modal-body">
						<div class="section-search-form padding-0 margin-bottom-20" style="float: right;">
							<form id="frmModal3" name="frmModal3" method="post" novalidate="novalidate">
								<select class="form-control" id="sKey" name="sKey">
									<option value="employee">개인</option>
									<option value="team">팀</option>
								</select>
								<input type="text" class="form-control half required" id="sValue" name="sValue" value="" placeholder="검색어를 입력하세요." autocomplete="off">
								<button type="button" class="btn btn-teal" id="btnSearch">검색</button>
							</form>
						</div>
		
						<div class="table-responsive table-objective margin-top-30" id="divEmpList3">
							<!-- from blankReceiveTargetList -->
						</div>
					</div>
		
					<!-- Modal Footer -->
					<div class="modal-footer clearfix">
						<button type="button" class="btn btn-teal btn-cancel" data-dismiss="modal">닫기</button>
					</div>
		
				</div>
			</div>
		</div>
		<!-- // Modal -->
		
		<!-- Modal :  결재문서첨부 -->
		<div id="addDocModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
			<div class="modal-dialog" style="width:1200px;height:auto;">
				<div class="modal-content">
		
					<!-- Modal Header -->
					<div class="modal-header">
						<h3 class="modal-title size-15 weight-400" id="myModalLabel"></h3>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
					</div>
		
					<!-- Modal Body -->
					<div class="modal-body" style="height:auto;">
						<form id="docFrm" name="docFrm" method="post">
							<input type="hidden" id="page" name="page" value="">
							
							<div class="row">
								<div class="col-xs-6">
									<h4 class="bul-1 margin-top-0">선택된 결재문서</h4>
								</div>
								<div class="col-xs-6 text-right">
									<!-- <button type="button" class="btn btn-sm btn-primary" onclick="fnc_sendDoc()"> -->
									<button type="button" class="btn btn-sm btn-primary" id="btnSendDoc">
											<i class="glyphicon glyphicon-circle-arrow-right" style="top: 2px"></i> 보내기
									</button>
								</div>
							</div>
							
							<div class="table-responsive table-objective">
								<table class="table table-bordered table-col">
									<colgroup>
										<col style="width: 7%;">
										<col style="width: 15%;">
										<col style="width: 10%;">
										<col style="width: 30%;">
										<col style="width: 10%;">
										<col style="width: 18%;">
										<col style="width: 10%;">
									</colgroup>
									<thead>
										<tr>
											<th>기능</th>
											<th>문서양식</th>
											<!-- <th>작성일자(▼)</th> -->
											<th>작성일자</th>
											<th>문서제목</th>
											<th>기안자</th>
											<th>문서번호</th>
											<th>결재상태</th>
										</tr>
									</thead>
									<tbody id="docModalTBody"></tbody>
								</table>
							</div>
			
							<div class="row margin-top-40">
								<div class="col-xs-3">
									<h4 class="bul-1 margin-top-10">결재문서 찾기</h4>
								</div>
								<div class="col-xs-9">
									<div class="section-search-form padding-0 margin-bottom-20 pull-right">
										<input type="text" class="form-control datepicker" id="startDt" name="startDt" placeholder="시작일" maxlength="11" autocomplete="off">
										<div class="pull-left margin-top-10 margin-right-10">~</div>
										<input type="text" class="form-control datepicker" id="endDt" name="endDt" placeholder="종료일" maxlength="11" autocomplete="off">
										<input type="text" class="form-control width-250" id="searchKey" name="searchKey" placeholder="문서제목, 문서번호, 작성자명" maxlength="50">
										<button type="button" class="btn btn-teal margin-right-0" id="btnDocSearch">검색</button>
									</div>
								</div>
							</div>
							
							<div id="docModalBody">
							</div>
						</form>
					</div>
		
					<!-- Modal Footer -->
					<div class="modal-footer clearfix">
						<button type="button" class="btn btn-teal btn-cancel" data-dismiss="modal">닫기</button>
					</div>
		
				</div>
			</div>
		</div>
		<!-- // Modal -->
		
		
		
		<!-- Modal :  결재문서매핑 -->
		<div id="mappingDocModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
			<div class="modal-dialog" style="width:1200px;height:auto;">
				<div class="modal-content">
		
					<!-- Modal Header -->
					<div class="modal-header">
						<h3 class="modal-title size-15 weight-400">기존문서 매핑</h3>
					</div>
		
					<!-- Modal Body -->
					<div class="modal-body" style="height:auto;">
						<h3 class="modal-title size-15 weight-400">- 비즈플레이와 연동된 정보만 제외하고 결재문서 정보를 아래 선택한 문서정보와 동일하게 설정합니다.</h3><br>
						<h3 class="modal-title size-15 weight-400">- 설정되는 정보는 본문내용, 결재라인, 첨부파일, 첨부결재문서, 수신자, 참조자 정보입니다.</h3><br>
						<h3 class="modal-title size-15 weight-400">- 기존에 이미 설정한 정보는 삭제됩니다.</h3>
						<form id="mappingFrm" name="mappingFrm" method="post">
							<input type="hidden" id="page" name="page" value="">
							
							<div class="row margin-top-40">
								<div class="col-xs-3">
									<h4 class="bul-1 margin-top-10">결재문서 찾기</h4>
								</div>
								<div class="col-xs-9">
									<div class="section-search-form padding-0 margin-bottom-20 pull-right">
										<input type="text" class="form-control datepicker" id="startDt" name="startDt" placeholder="시작일" maxlength="11" autocomplete="off">
										<div class="pull-left margin-top-10 margin-right-10">~</div>
										<input type="text" class="form-control datepicker" id="endDt" name="endDt" placeholder="종료일" maxlength="11" autocomplete="off">
										<input type="text" class="form-control width-250" id="searchKey" name="searchKey" placeholder="문서제목, 문서번호, 작성자명" maxlength="50">
										<button type="button" class="btn btn-teal margin-right-0" id="btnMappingSearch">검색</button>
									</div>
								</div>
							</div>
							
							<div id="mappingModalBody">
							</div>
						</form>
					</div>
		
					<!-- Modal Footer -->
					<div class="modal-footer clearfix">
						<button type="button" class="btn btn-teal btn-cancel" data-dismiss="modal">닫기</button>
					</div>
		
				</div>
			</div>
		</div>
		<!-- // Modal -->
		
		
		
		
		<!-- <form name="loadingFrm" >
			
		</form> -->
		
		<style>
		.error {border: #bf6464 2px dashed !important; background-color: #fdfbfb !important;}
		.info {border: solid 1px #337ab7; border-radius: 3px; height: 26px; margin-left: 9px; margin-bottom: 2px; color: #337ab7; padding: 3px 10px !important; font-weight: 500;}
		.section-title .title:before {height: 14px !important;}
		</style>
		
		<script type="text/javascript">
			var ajaxUtil = new AjaxUtil();
			var callUrl = "";
			var param = "";
			var sel_files = [];
			
			
			//결재 모듈 화면구성 set
			function ApprvSet(){
				this.apprvIdx = "";
				this.docCd = "";		//결재문서 타입
				this.statusCd = "";
				this.cancelYn = "";
				this.docObj;
				
				//결재 문서 조회 위치
				this.docLocation = new Map();
				this.docLocation.set("writePage", "apply");
				this.docLocation.set("approvalPage", "exec");
				this.docLocation.set("receiptPage", "recept");
				
				//결재 문서 상태
				this.apprvStatus = new Map();
					
					this.apprvStatus.set("temp", "SC001");
					
					this.apprvStatus.set("ongoing", "SC002");
					
					this.apprvStatus.set("reject", "SC004");
					
					this.apprvStatus.set("end", "SC003");
				
				
				//결재활동 코드 설정;
				this.apprvAct = new Map();
					
					this.apprvAct.set("wait", "SC001");
					
					this.apprvAct.set("approval", "SC002");
					
					this.apprvAct.set("reject", "SC003");
				
			}
			
			
			ApprvSet.prototype.Event_Write = function(){
				
				// 수정, 신규등록, 임시저장
				var fnc_save = function(msg){
					var resultMsg = (msg.indexOf("임시") == 0 ) ? "저장 되었습니다." : "완료 되었습니다.";
					if(fnc_isValidInput()) {
						bConfirm(msg).done(function(s) {
							if(s) {
		
								$('#input_imgs').remove(); // frmWrite 폼 안에 있는 input type="file" 제거
								
								var frm1 = document.getElementById("frmWrite");
								var dataArray = new FormData(frm1);
								
								var fileSize = sel_files.length;
								if(fileSize > 0){
									for(var i = 0 ; i < fileSize ; i++){
										dataArray.append("file1", sel_files[i]);
		
									}
								}
		
								
		
								// 결재문서가 있는 경우 첨부
								if($('div[id=docDiv]').length > 0){
									$('div[id=docDiv]').each(function(){
										var idx = $(this).data('idx');
										var docCd = $(this).data('cd');
										var title = $(this).children().eq(1).text();
		
										dataArray.append("docApprvIdx",idx);
										dataArray.append("docCd",docCd);
										dataArray.append("docTitle",title);
									});
								}else{
									dataArray.append("docApprvIdx","");
									dataArray.append("docCd","");
									dataArray.append("docTitle","");
								}
								
								
								
								$.ajax({
									type:"post"
									,url:"/apprv/apply/ajaxSaveApproval"
									,data: dataArray
									,dataType: "json"
									,enctype : 'multipart/form-data'
									,processData : false
									,contentType : false
									,success: function(data) {
										if(data.result == 1) {
											fnc_toastMsgForResult(resultMsg);
											fnc_List();
											
										} else {
											fnc_toastMsgForWarning(data.resultMsg);
										}
									}
									,error: function(responseJSON, status, err) {
									}
								});
							}
						});
					}
				}
				
				
				var fnc_Cancel = function(apprv_idx){
					var apprvIdx = apprv_idx;
					bConfirm("제출취소하시겠습니까?").done(function(s) {
						if(s) {
							$.ajax({
								type:"post"
								,url:"/apprv/apply/ajaxCancelApproval"
								,data: { apprv_idx:apprvIdx, docCd:$("#frmWrite #docCd").val() }
								,dataType: "json"
								,success: function(data) {
									if(data.result == 1) {
										fnc_toastMsgForResult("제출취소되었습니다.");
										fnc_List();
										
									} else {
										fnc_toastMsgForWarning(data.resultMsg);
									}
								}
								,error: function(responseJSON, status, err) {
								}
							});
						}
					});
					
				}
				
				
				
				if(this.apprvIdx == "" || this.apprvIdx == null || this.statusCd == this.apprvStatus.get('temp')){
					//임시저장
					$("#btnSave").on("click", function(){
						$("#frmWrite #status_cd").val(_apprv.apprvStatus.get('temp'));
						var msg = "임시 저장하시겠습니까?";
						fnc_save(msg);
					});
					
					
					//저장
					$("#btnApply").on("click", function(){
						$("#frmWrite #status_cd").val(_apprv.apprvStatus.get('ongoing'));
						var msg = "결재를 요청하시겠습니까?";
						fnc_save(msg);
					});
					
					
				}else{
					
					//수정
					$("#btnModify").on("click", function(){
						$("#frmWrite #status_cd").val(_apprv.apprvStatus.get('ongoing'));
						var msg = "수정하시겠습니까?";
						fnc_save(msg);
					});
					
					
					//신청취소
					$("#btnCancel").on("click", function(){
						fnc_Cancel($("#frmWrite #apprv_idx").val());
					});
				}
			}
			
			
			ApprvSet.prototype.Header_Write = function(){
				
				if(this.apprvIdx == "" || this.apprvIdx == null || this.statusCd == this.apprvStatus.get('temp')){
					
					//---문서 중반  버튼생성
					var docMiddle = document.querySelector("#docMiddleArea");
					docMiddle.innerHTML = `
						<button type="button" class="btn btn-sm width-120 btn-danger" 
							id="btnList" >작성취소</button>
						<button type="button" class="btn btn-sm width-120 btn-teal" 
							id="btnSave" >임시저장</button>	
						
					`;
					
					//---문서 하단 버튼생성
					var docBottom = document.querySelector("#docBottomArea");
					docBottom.innerHTML = `
						<button type="button" class="btn btn-lg width-120 btn-primary" 
						id="btnApply" >결재요청</button>	
					`;
					
				}else{
					
					//---문서 중반  버튼생성
					var docMiddle = document.querySelector("#docMiddleArea");
					docMiddle.innerHTML = `
						<button type="button" class="btn btn-sm width-120 btn-teal" 
								id="btnList"  >목록</button>
					`;
							
					//---문서 하단 버튼생성
					var docBottom = $("#docBottomArea");
					var btnElement;
					btnElement = $("<button type=\"button\" class=\"btn btn-lg width-120 btn-primary\" id=\"btnModify\"  >수정</button>");
					docBottom.append(btnElement);
					
					//조건 필요
					btnElement = $("<button type=\"button\" class=\"btn btn-lg width-120 btn-danger margin-left-10\" id=\"btnCancel\" >제출취소</button>");
					if(this.cancelYn == "Y") btnElement.attr("disabled", true);
					docBottom.append(btnElement);
				}	
				
			}
			
			
			ApprvSet.prototype.Header_Approval = function(){
				//---문서 중반  버튼생성
				var docMiddle = document.querySelector("#docMiddleArea");
				docMiddle.innerHTML = `
					<button type="button" class="btn btn-sm width-120 btn-teal" 
							id="btnList"  >목록</button>
				`;
				
				
				//---문서 하단 버튼생성
				var docBottom = document.querySelector("#docBottomArea");
				docBottom.innerHTML = `
					<button type="button" class="btn btn-lg width-120 btn-primary" 
					id="btnApprovalModify" >수정</button>	
				`;
				
				
			}
			
			ApprvSet.prototype.Event_Approval = function(){
				
				// 결재화면에서 저장
				var fnc_saveApproval = function(msg){
					var resultMsg = "완료 되었습니다.";
					if(fnc_isValidInput()) {
						bConfirm(msg).done(function(s) {
							if(s) {
		
								$('#input_imgs').remove(); // frmWrite 폼 안에 있는 input type="file" 제거
								
								var frm1 = document.getElementById("frmWrite");
								var dataArray = new FormData(frm1);
								
								var fileSize = sel_files.length;
								if(fileSize > 0){
									for(var i = 0 ; i < fileSize ; i++){
										dataArray.append("file1", sel_files[i]);
									}
								}
								
								
								// 결재문서가 있는 경우 첨부
								if($('div[id=docDiv]').length > 0){
									$('div[id=docDiv]').each(function(){
										var idx = $(this).data('idx');
										var docCd = $(this).data('cd');
										var title = $(this).children().eq(1).text();
		
										dataArray.append("docApprvIdx",idx);
										dataArray.append("docCd",docCd);
										dataArray.append("docTitle",title);
									});
								}else{
									dataArray.append("docApprvIdx","");
									dataArray.append("docCd","");
									dataArray.append("docTitle","");
								}
								
								
								$.ajax({
									type:"post"
									,url:"/apprv/exec/ajaxSaveApproval"
									,data: dataArray
									,dataType: "json"
									,enctype : 'multipart/form-data'
									,processData : false
									,contentType : false
									,success: function(data) {
										if(data.result == 1) {
											fnc_toastMsgForResult(resultMsg);
											fnc_List();
										} else {
											fnc_toastMsgForWarning(data.resultMsg);
										}
									}
									,error: function(responseJSON, status, err) {
									}
								});
							}
						});
					}
				}
				
				
				//결재수정  -- 결재 > 수정 > 저장
				$("#btnApprovalModify").on("click", function(){
					$("#frmWrite #status_cd").val(_apprv.apprvStatus.get('ongoing'));
					var msg = "수정하시겠습니까?";
					fnc_saveApproval(msg);
					
				});
				
			}
			
			
			
			//결재자 설정 이벤트 
			ApprvSet.prototype.approvalLineSet = function(){
				
				//결재자 조회
				var getEmpList = function(){
					if($("#frmModal1").valid()) {
						var param = $("#frmModal1").serializeArray();
						
						$.post("/apprv/apply/blankEmpList", param, function(data) {
							$("#divEmpList").html(data);
						});
					} else {
						$("#frmModal1 .error").eq(0).focus();
						fnc_toastMsgForWarning("이름을 입력해주세요.");
						return false;
					}
					
				}
				
				//결재자 추가 폼 생성
				var appendEleForA = function(apprvMap){
					var ldap_id = apprvMap['ldapId'];
					var emp_name = apprvMap['empName'];
					var team_name = apprvMap['teamName'];
					var grade_name = apprvMap['gradeName'];
					var chrgCd = apprvMap['chrgCd'];
					var chrgNm = apprvMap['chrgNm'];
					var modifyYn = apprvMap['modifyYn'];
					
					if(modifyYn == "Y"){
						//수정 결재자 폼 
						var newElements = $(`
								<li>
									<div class="field-1">
										<select class="form-control" id="chrgCd" name="chrgCd">
											<option value="SC002" selected>결재자</option>
											<option value="SC003" >합의자</option>
											<option value="SC004" >승인자</option>
										</select>
										<a class="remove-a" ><i class="fa fa-close"></i></a>
										<input type="hidden" name="ldap_id" id="ldap_id" />
									</div>
									<div class="field-2"></div>
									<div class="field-3"></div>
									<div class="field-4"></div>
								</li>
						`);
						
						
						
						if(chrgCd != ""){
							newElements.find("select[name=chrgCd]").val(chrgCd);	
						}
						newElements.find("input[name=ldap_id]").val(ldap_id);
						newElements.find(".field-2").html(team_name);	// 팀명
						newElements.find(".field-3").html(emp_name);		// 이름
						newElements.find(".field-4").html(grade_name);	// 직책
						$("#ulSort").last().append(newElements);
						
					}else{
						//미수정 결재자 폼 (submit으로 전달되지 않도록 name 없음 )
						var staticElements = $(`
							<li>
								<input type="hidden" id="ldap_id" /> 
								<input type="hidden" id="chrgCd" />
								<div class="field-1"></div>
								<div class="field-2"></div>
								<div class="field-3"></div>
								<div class="field-4"></div>
							</li>
						`);
						
						staticElements.find("input[id=ldap_id]").val(ldap_id);
						staticElements.find("input[id=chrgCd]").val(chrgCd);
						staticElements.find(".field-1").html(chrgNm);
						staticElements.find(".field-2").html(team_name);		// 팀명
						staticElements.find(".field-3").html(emp_name);		// 이름
						staticElements.find(".field-4").html(grade_name);	// 직책
						
						$("#ulApproval").append(staticElements);
					}
					$("#divApproval").removeClass("error");
				}
				
				//결재자 추가 폼 제거
				var removeEleForA = function(obj){
					obj.closest("li").remove();	
				}
				
				
				//결재 라인 데이터 조회 
				if('[]' != '[]'){
					var apprvList = JSON.parse('[]');
					if(apprvList.length > 0) {
						
						$.each(apprvList, function(i, item) {
							
							//작성자이거나, 본인이거나, 이미 결재를 한 경우에는 결재폼을 수정할 수 없다.
							var modifyYn = "Y";
							if(item.CHRG_CD == 'SC001' || item.STATUS_CD != 'SC001' || ( item.LDAP_ID == $("#loginId").val() && item.CHRG_CD == 'SC001' ) ){
								modifyYn = "N";	
							}
							appendEleForA({
								ldapId : item.LDAP_ID,
								empName : item.EMP_NAME,
								teamName : item.TEAM_NAME,
								gradeName : item.GRADE_NAME,
								chrgCd : item.CHRG_CD,
								chrgNm : item.CHRG_NM,
								modifyYn : modifyYn
							});	
						});
					}
					
				}else if('{"EMP_NAME":"김현경","TEAM_NAME":"플랫폼개발2팀","DOC_NM":"독서모임 신청 및 도서구입 결의서","REGDT":"2021-03-12","GRADE_NAME":"매니저","TEAM_IDX":239,"LDAP_ID":"hkkim5"}' != ''){
					var empInfo = JSON.parse('{"EMP_NAME":"김현경","TEAM_NAME":"플랫폼개발2팀","DOC_NM":"독서모임 신청 및 도서구입 결의서","REGDT":"2021-03-12","GRADE_NAME":"매니저","TEAM_IDX":239,"LDAP_ID":"hkkim5"}');
					appendEleForA({
						ldapId : empInfo.LDAP_ID,
						empName : empInfo.EMP_NAME,
						teamName : empInfo.TEAM_NAME,
						gradeName : empInfo.GRADE_NAME,
						chrgCd : 'SC001',
						chrgNm : '작성자',
						modifyYn : 'N'
					});	
				}
		
				//결재자 순서 변경
				$("#ulSort").sortable().disableSelection();
				
				//결재자 추가 모달 오픈
				$("#sapprovalLine1").on("shown.bs.modal", function(){
					$("#frmModal1 #sValue").focus();
				});
				
				//결재자 추가 모달 닫기
				$("#sapprovalLine1").on("hide.bs.modal", function(){
					$("#frmModal1 #sValue").val("");
					$("#divEmpList").html("");
				});
				
				
				//결재자 추가 조회
				$("#sapprovalLine1 #btnSearch").on("click", function(){
					getEmpList();
				});
				
				//결재자 추가 엔터 조회
				$("#sapprovalLine1 #sValue").on("keypress", function(e){
					if(e.keyCode == 13){
						getEmpList();
						e.preventDefault();
					}
				});
				
				//결재자 추가
				//작성자는 결재라인에 들어갈 수 없다. 중복 체크와 동일 
				//본인을 삭제할 수 있나?
				$("#sapprovalLine1").on("click", "#tbApproval tr", function(){
					var ldap_id = $(this).data("ldap_id");
					var emp = $(this).data("emp");
					var grade = $(this).data("grade");
					var team = $(this).data("team");
					var b = true;
					
					//본인결재 막을 시 필요
					$("#ulApproval > li").each(function(){	//기결재자 
						let chrgCd = $(this).find("#chrgCd").val(); 
						if($(this).find("#ldap_id").val() == ldap_id && chrgCd != 'SC001') {
							fnc_toastMsgForWarning("이미 결재라인에 추가되어 있습니다.");
							b = false;
							return false;
						}
					});
					
					$("#ulSort > li").each(function(){
						//console.log($(this).find("#ldap_id").val());
						if($(this).find("#ldap_id").val() == ldap_id) {
							fnc_toastMsgForWarning("이미 결재라인에 추가되어 있습니다.");
							b = false;
							return false;
						}
					});
					
					
					if(ldap_id == ""){
						b = false;
						return false;
					}
					
					if(b) {
						appendEleForA({
							ldapId : ldap_id,
							empName : emp,
							teamName : team,
							gradeName : grade,
							chrgCd : '',
							modifyYn : 'Y'
						});
						$("#sapprovalLine1").modal("hide");
					}
				});
				
				
				//결재자 제거
				$(document).on("click", "a[class=remove-a]", function(){
					removeEleForA($(this));
				});
				
			}
			
			//수신자 설정 셋
			ApprvSet.prototype.dstrbLineSet = function(){
				
				//수신자 설정 폼 
				var appendEleForR = function(baseYn){
					
					var receive_id = $("#frm2 #receive_id").val();
					var name = $("#frm2 #name").val();
					
					var elHtml = "";
					elHtml += "<span>";
					elHtml += "<input type=\"hidden\" id=\"receive_id\" name=\"receive_id\" value=\""+receive_id+"\">"
					
					if(baseYn == "Y") elHtml += 	name;
					else elHtml += 	name + "<a class=\"remove-r\">[<i class=\"fa fa-close\"></i>]</a>"; 
					
					elHtml += "</sapn>";
					$("#divReceive").last().append(elHtml);
					
				}
				
				//수신자 목록 조회
				var getDstrbEmpList = function(){
					if($("#frmModal2").valid()) {
						var param = $("#frmModal2").serializeArray();
						
						$.post("/apprv/apply/blankReceiveTargetList", param, function(data) {
							$("#divEmpList2").html(data);
						});
					} else {
						$("#frmModal2 .error").eq(0).focus();
						fnc_toastMsgForWarning("이름을 입력해주세요.");
						return false;
					}
					
				}
				
				//수신자 설정 제거
				var removeEleForR = function(obj){
					obj.closest("span").remove();	
				}
				
				
				//수신자
				if('[]' != "[]"){
					$("#divReceive").children().remove();
					var dstrbList = JSON.parse('[]');
					$.each(dstrbList, function(i, item) {
						$("#frm2 #receive_id").val(item.RECEIVE_ID);
						$("#frm2 #name").val(item.RECEIVE_NAME);
						appendEleForR(item.BASE_YN);
					});
				}
				
				//수신자 추가 모달 오픈
				$("#sapprovalLine2").on("shown.bs.modal", function(){
					$("#frmModal2 #sValue").focus();
				});
				
				//수신자 추가 모달 닫기
				$("#sapprovalLine2").on("hide.bs.modal", function(){
					$("#frmModal2 #sKey option:first").prop("selected", true);
					$("#frmModal2 #sValue").val("");
					$("#divEmpList2").html("");
				});
				
				//수신자 추가 조회
				$("#sapprovalLine2 #btnSearch").on("click", function(){
					getDstrbEmpList();
				});
				
				//수신자 추가 엔터 조회
				$("#sapprovalLine2 #sValue").on("keypress", function(e){
					if(e.keyCode == 13){
						getDstrbEmpList();
						e.preventDefault();
					}
				});
				
				//수신자 추가
				$("#sapprovalLine2").on("click", "#tbReceive tr", function(){
					var receive_id = $(this).data("receive_id");
					var name = $(this).data("name");
					var key = $(this).data("key");
					
					var b = true;
					$("#divReceive > span").each(function(){
						if($(this).find("input").closest("#receive_id").val() == receive_id) {
							fnc_toastMsgForWarning("이미 수신자에 추가되어 있습니다.");
							b = false;
							return false;
						}
					});
					
					if(receive_id == ""){
						b = false;
						return false;
					}
					
					if(b){
						$("#frm2 #receive_id").val(receive_id);
						name = (key == "employee") ? name+"("+receive_id+")" : name;
						$("#frm2 #name").val(name);
						
						appendEleForR('N'); 
						$("#sapprovalLine2").modal("hide");
					}
				});
				
				//수신자 제거 
				$(document).on("click", "a[class=remove-r]", function(){
					removeEleForR($(this));
				});
			}
			
			//참조자 설정 셋
			ApprvSet.prototype.referLineSet = function(){
				
				//참조자 설정 폼 
				var appendEleForF = function(baseYn){
					
					var refer_id = $("#frm2 #receive_id").val();
					var name = $("#frm2 #name").val();
					
					var elHtml = "";
					elHtml += "<span>";
					elHtml += "<input type=\"hidden\" id=\"refer_id\" name=\"refer_id\" value=\""+refer_id+"\">"
					
					if(baseYn == "Y") elHtml += 	name;
					else elHtml += 	name + "<a class=\"remove-f\">[<i class=\"fa fa-close\"></i>]</a>"; 
					
					elHtml += "</sapn>";
					$("#divRefer").last().append(elHtml);
					
				}
				
				//참조자 목록 조회
				var getReferEmpList = function(){
					if($("#frmModal3").valid()) {
						var param = $("#frmModal3").serializeArray();
						
						$.post("/apprv/apply/blankReceiveTargetList", param, function(data) {
							$("#divEmpList3").html(data);
						});
					} else {
						$("#frmModal3 .error").eq(0).focus();
						fnc_toastMsgForWarning("이름을 입력해주세요.");
						return false;
					}
					
				}
				
				//참조자 설정 제거
				var removeEleForF = function(obj){
					obj.closest("span").remove();	
				}
				
				
				//참조자
				if('[]' != "[]"){
					$("#divRefer").children().remove();
					var referList = JSON.parse('[]');
					$.each(referList, function(i, item) {
						console.log(item.RECEIVE_ID);
						$("#frm2 #receive_id").val(item.RECEIVE_ID);
						$("#frm2 #name").val(item.RECEIVE_NAME);
						appendEleForF(item.BASE_YN);
					});
				}
				
				//참조자 추가 모달 오픈
				$("#sapprovalLine3").on("shown.bs.modal", function(){
					$("#frmModal3 #sValue").focus();
				});
				
				//참조자 추가 모달 닫기
				$("#sapprovalLine3").on("hide.bs.modal", function(){
					$("#frmModal3 #sKey option:first").prop("selected", true);
					$("#frmModal3 #sValue").val("");
					$("#divEmpList3").html("");
				});
				
				//참조자 추가 조회
				$("#sapprovalLine3 #btnSearch").on("click", function(){
					getReferEmpList();
				});
				
				//참조자 추가 엔터 조회
				$("#sapprovalLine3 #sValue").on("keypress", function(e){
					if(e.keyCode == 13){
						getReferEmpList();
						e.preventDefault();
					}
				});
				
				//참조자 추가
				$("#sapprovalLine3").on("click", "#tbReceive tr", function(){
					var refer_id = $(this).data("receive_id");
					var name = $(this).data("name");
					var key = $(this).data("key");
					
					var b = true;
					$("#divRefer > span").each(function(){
						if($(this).find("input").closest("#refer_id").val() == refer_id) {
							fnc_toastMsgForWarning("이미 참조자에 추가되어 있습니다.");
							b = false;
							return false;
						}
					});
					
					if(refer_id == ""){
						b = false;
						return false;
					}
					
					if(b){
						$("#frm2 #receive_id").val(refer_id);
						name = (key == "employee") ? name+"("+refer_id+")" : name;
						$("#frm2 #name").val(name);
						
						appendEleForF('N'); 
						$("#sapprovalLine3").modal("hide");
					}
				});
				
				//수신자 제거 
				$(document).on("click", "a[class=remove-f]", function(){
					removeEleForF($(this));
				});
			}
			
			//첨부문서 관련 이벤트 설정
			ApprvSet.prototype.multiFileSet = function(){
				
				var fileForm = `
					<div class="alert alert-mini alert-default inline-block margin-top-10 margin-bottom-0">
						<button type="button" class="close margin-left-20" data-dismiss="alert">
							<span aria-hidden="true" id="removeFile" style="cursor:pointer;" >×</span>
							<span class="sr-only">삭제</span>
						</button>
						<a href="javascript:fnc_fileDownload(XXSEQ);"><span>XXNAME</span></a>
						
						<input type="hidden" id="filesize" name="filesize" value="XXSIZE" />
						<input type="hidden" id="filename" name="filename" value="XXNAME" />
						<input type="hidden" id="fileseq"  name="fileseq"  value="XXSEQ" />
						<input type="hidden" id="filepath" name="filepath" value="XXPATH" />
						
						<br/>
					</div>`;
				
				var imgForm = `
					<div class="col-xs-3">
						<a href="XXURL" class="thumbnail" title="XXNAME">
							<img src="XXURL" alt="XXNAME" class="img-fluid">
						</a>
						<div class="ttl">
							<a href="javascript:fnc_fileDownload(XXSEQ);">XXNAME</a>
							<span aria-hidden="true" class="cls" id="removeFile" style="cursor:pointer;">×</span>
						</div>
						<div class="bite">(XXMBSIZE)</div>
						
						<input type="hidden" id="filesize" name="filesize" value="XXSIZE" />
						<input type="hidden" id="filename" name="filename" value="XXNAME" />
						<input type="hidden" id="fileseq"  name="fileseq"  value="XXSEQ" />
						<input type="hidden" id="filepath" name="filepath" value="XXPATH" />
						
					</div>`;
					
				//파일 폼 append 공통 
				var formAppend = function(formTmp, appendArea, url, name, size, seq, path){
					formTmp = formTmp.replace(/XXURL/gi,	url);
					formTmp = formTmp.replace(/XXNAME/gi, 	name);
					formTmp = formTmp.replace(/XXSIZE/gi, 	size);
					formTmp = formTmp.replace(/XXMBSIZE/gi, (size / (1024 * 1024)).toFixed(2) + " MB");
					formTmp = formTmp.replace(/XXSEQ/gi, 	seq);
					formTmp = formTmp.replace(/XXPATH/gi, 	path);
					appendArea.append(formTmp);
				}
					
				//기 저장된 파일정보 조회 
				if('[]' != '[]'){
					var fileList = JSON.parse('[]');
					if(fileList.length > 0) {
						for(var i = 0 ; i < fileList.length ; i++){
							fl = fileList[i];
							var formTmp;
							var appendArea;
							if(fl.FILEEXT == 'jpg' || fl.FILEEXT == 'png' || fl.FILEEXT == 'jpeg'){
								formTmp = imgForm;	
								appendArea = $("#multipartArea .file-gallery"); 
							}else{
								formTmp = fileForm;
								appendArea = $("#multipartArea .non-img-file");
							}
							formAppend(formTmp
									, appendArea
									, "http://d-pds.eduwill.net" + "/people" + fl.FILEPATH
									, fl.FILENAME
									, fl.FILESIZE
									, fl.SEQ
									, fl.FILEPATH);	
							
						}
					}
					
				}	
				
				
				$('#multipartArea .file-gallery .thumbnail').viewbox();
				
				// 첨부파일 click event		
				$("#btnAddFile").on("click", function(e){
					e.preventDefault();
					$("#input_imgs").click();
				});
				
				//파일 첨부 이벤트 
				$("#input_imgs").on("change", function(e){
					var files = e.target.files;
					var filesArr = Array.prototype.slice.call(files);
					filesArr.forEach(function(f){
						var type = f.type;
						var size = f.size;
						var name = f.name;
						var allowExt = [
							'jpg', 'jpeg', 'pdf', 'png', 'ppt','pptx','doc','docx'
							,'hwp', 'xls','xlsx', 'zip','txt','bmp'
							
						];
						
						var extTmp = name.split('.');
						if(extTmp == null || extTmp.length < 1){
							fnc_toastMsgForWarning("파일 형태가 잘못되었습니다.");
							return false;
						}
						
						var len = extTmp.length;
						var ext = extTmp[len - 1].toLowerCase();
						
						
						//파일 업로드 갯수 제한
						if($("#filename").length + 1 >= 10){
							fnc_toastMsgForWarning("최대 10개까지 첨부 가능합니다.");
							return false;
						}
						
						//확장자 확인
						/* if(allowType.indexOf(type) == -1) {
							fnc_toastMsgForWarning("파일은 JPG, PNG, PDF, ppt, pptx, 한글, 워드, 엑셀, zip 형식만 가능합니다.");
							return false;
						} */
						
						ext = ext.replace("$enc$", "");	//암호화 문서 포함
						if(allowExt.indexOf(ext) == -1) {
							fnc_toastMsgForWarning("파일은 JPG, PNG, PDF, ppt, pptx, 한글, 워드, 엑셀, zip 형식만 가능합니다.");
							return false;
						}
						
						//파일 총 용량 제한(30MB)
						/* var allowSize = 30 * 1024 * 1024;
						var totalSize = size;
						$("input[id=filesize]").each(function(){
							totalSize += Number($(this).val());
						});
						
						if(allowSize < totalSize) {
							fnc_toastMsgForWarning("파일 용량은 최대 30MB 입니다.");
							return false;
						} */
		
						
						// 파일 개별 사이즈 제한(30MB)
						var allowSize = 30 * 1024 * 1024;
						if(size > allowSize){
							fnc_toastMsgForWarning("30MB 이상의 파일은 첨부할 수 없습니다.");
							return false;
						} 
						
						
						
						sel_files.push(f);
						var reader = new FileReader();
						reader.onload = function(e){
							var formTmp;
							var appendArea;
							if(['image/jpeg', 'image/png'].indexOf(type) == -1){	//이미지 아님
								formTmp = fileForm;
								appendArea = $("#multipartArea .non-img-file");
							}else{
								formTmp = imgForm;
								appendArea = $("#multipartArea .file-gallery");
							}
							
							formAppend(formTmp
										,appendArea
										,e.target.result
										,name
										,size
										,0
										,"");	
							
						}					
						reader.readAsDataURL(f);
						
						
					});
					
					$("#input_imgs").val("");
					
				});
				
				
				
				//파일 삭제
				$(document).on("click", "#removeFile", function(){
					
					//폼에서 파일 이름 찾기 
					var fileForm = $(this).parent().parent();
					var filename = fileForm.find("#filename").val();
					var fileseq = fileForm.find("#fileseq").val();
					
					//등록된 파일중에 파일이름과 같은 게 있다면 삭제
					if(sel_files.length > 0){
						for(var i = 0; i < sel_files.length ; i++){
							var f = sel_files[i];
							if(f.name == filename) sel_files.splice(i,1);
						}
					}
					//console.log(sel_files);
					$(this).parent().parent().remove();
					
				});
				
			}
			
			//결재문서 첨부 이벤트 
			ApprvSet.prototype.docSet = function(){
				
				//모달문서 초기화
				var docInit = function(){
					//console.log("reach this line");
					let toDt = $.datepicker.formatDate('yy-mm-dd', new Date());
					let fromDt = new Date(toDt);
					fromDt.setMonth(fromDt.getMonth()-1);
					fromDt = (fromDt.getFullYear() + '-' + 
								('0' + (fromDt.getMonth()+1)).slice(-2) + '-' + 
									('0' + (fromDt.getDate()+1)).slice(-2));
					$("#docFrm #startDt").val(fromDt);
					$("#docFrm #endDt").val(toDt);
					
				}
				
		
				var sendDoc = function(){
					if($('#docModalTBody').html() == ''){
						fnc_toastMsgForWarning("선택된 결제문서가 없습니다.");
						return false;
					}
					
					// 문서 div
					var str = `
						<div data-idx="XXIDX" data-cd="XXCD" id="docDiv" class="alert alert-mini alert-default inline-block margin-top-10 margin-bottom-0"><!-- file-register -->
							<button type="button" class="close margin-left-20" data-dismiss="alert">
								<span aria-hidden="true">×</span>
								<span class="sr-only">삭제</span>
							</button>
							<a href="javascript:fnc_popupApprvDoc('XXIDX', 'XXCD');"><span>XXTITLE</span></a>
						</div>
					`
					
					// 결재문서 첨부 영역에 추가
					$('#docModalTBody').children().each(function(){
						var idx = $(this).data('idx');
						var docCd = $(this).data('cd');
						var title = $(this).find('#docTitle').text();
		
						var _str = str;
						_str = _str.replace(/XXIDX/gi, idx);
						_str = _str.replace(/XXCD/gi, docCd);
						_str = _str.replace(/XXTITLE/gi, title);
		
						
						// 문서 중복 체크
						if($('div[id=docDiv]').length == 0){
							$('#docDivArea').append(_str);
						}else{
							var a = []
							$('div[id=docDiv]').each(function(){
								a.push($(this).data('idx')) 
							});
							
							if(a.indexOf(idx) == -1){
								$('#docDivArea').append(_str);
							}
						}
						
							
					});
		
					$('#addDocModal').modal('hide');	// 모달 닫기
					$('#docModalTBody').html('');	// 선택된 결재문서 내역 초기화`
					
				}
				
				
				var addDoc = function(obj){
					//var str = '<button type="button" class="btn btn-sm btn-default" onclick="fnc_removeDoc($(this))">삭제</button>';
					var str = '<button type="button" class="btn btn-sm btn-default" >삭제</button>';
					var cloneTr = obj.closest('tr').clone();
					cloneTr.find('#btnTd').html(str);		
					$('#docModalTBody').append(cloneTr);	
				}
				
				var docSearch = function(){
					var date_pattern = /[0-9]{4}-[0-9]{2}-[0-9]{2}/;
					let startDt = $('#docFrm #startDt').val();
					let endDt = $('#docFrm #endDt').val();
					
		
					// 날짜 패턴 체크
					if( (startDt != '' && endDt == '') || (startDt == '' && endDt != '') ){
						fnc_toastMsgForWarning("시작일과 종료일을 모두 입력해 주세요");
						return false;
						
					}else{
						if(startDt != '' && date_pattern.test(startDt) == false){
							$("#docFrm #startDt").addClass("error");
							$("#docFrm #startDt").focus();
							fnc_toastMsgForWarning("날짜형식을 확인해 주세요 ex)2020-10-29");
							return false;
						}
						$("#docFrm #startDt").removeClass("error");
						
						if(endDt != '' && date_pattern.test(endDt) == false){
							$("#docFrm #endDt").addClass("error");
							$("#docFrm #endDt").focus();
							fnc_toastMsgForWarning("날짜형식을 확인해 주세요 ex)2020-10-29");
							return false;
						}
						$("#docFrm #endDt").removeClass("error");
						
					}
					fnc_getDocList(1);
				}
				
				
				// 문서첨부 클릭 이벤트 (지출결의서 전용)
				$('#btnAddDoc').on('click', function(){
					fnc_getDocList(1);
					$('#addDocModal').modal('show');
				});
				
				// 문서 검색
				$("#btnDocSearch").on("click", function(){
					docSearch();
				});
				
				
				// 결재문서 추가 
				$(document).on("click", "#docTbody > tr > td > button", function(){
					addDoc($(this));
					
				});
				
				
				//선택된 결재문서 삭제
				$(document).on("click", "#docModalTBody > tr > td > button", function(){
					$(this).closest('tr').remove();		
					
				});
				
				
				//선택된 결재문서 매핑
				$("#btnSendDoc").on("click", function(){
					sendDoc();
				});
				
				
				docInit();
				
				
			}
			
			
			
			//결재문서 매핑 이벤트 
			ApprvSet.prototype.mappingSet = function(){
				
				
				//모달문서 초기화
				var mappingInit = function(){
					//console.log("reach this line");
					let toDt = $.datepicker.formatDate('yy-mm-dd', new Date());
					let fromDt = new Date(toDt);
					fromDt.setMonth(fromDt.getMonth()-1);
					fromDt = (fromDt.getFullYear() + '-' + 
								('0' + (fromDt.getMonth()+1)).slice(-2) + '-' + 
									('0' + (fromDt.getDate()+1)).slice(-2));
					$("#mappingFrm #startDt").val(fromDt);
					$("#mappingFrm #endDt").val(toDt);
					
				}
				
				
				
				//검색
				var search = function(){
					var date_pattern = /[0-9]{4}-[0-9]{2}-[0-9]{2}/;
					let startDt = $('#mappingFrm #startDt').val();
					let endDt = $('#mappingFrm #endDt').val();
		
					// 날짜 패턴 체크
					if( ( startDt != '' && endDt == '' ) || ( startDt == '' && endDt != '' ) ){
						fnc_toastMsgForWarning("검색 시작일과 종료일을 모두 입력해 주세요");
						return false;
						
					}else{
						if(startDt != '' && date_pattern.test(startDt) == false){
							$("#mappingFrm #startDt").addClass("error");
							$("#mappingFrm #startDt").focus();
							fnc_toastMsgForWarning("날짜형식을 확인해 주세요 ex)2020-10-29");
							return false;
						}
						$("#mappingFrm #startDt").removeClass("error");
						
						
						if(endDt != '' && date_pattern.test(endDt) == false){
							$("#mappingFrm #endDt").addClass("error");
							$("#mappingFrm #endDt").focus();
							fnc_toastMsgForWarning("날짜형식을 확인해 주세요 ex)2020-10-29");
							return false;
						}
						$("#mappingFrm #endDt").removeClass("error");
						
					}
					fnc_getMappingList(1);
		
				}
				
				
				//매핑
				var mapping = function(apprvIdx){
					if(apprvIdx == 0 || apprvIdx == ""){
						fnc_toastMsgForWarning("결재정보가 올바르지 않습니다.");
						return false;
					}
					
					bConfirm("연동정보를 제외한 기존의 설정 정보는 삭제됩니다. 매핑하시겠습니까?").done(function(s) {
						if(s) {
							$.ajax({
								type:"post"
								,url:"/apprv/apply/ajaxMappingUpdate"
								,data: {
									"targetApprvIdx" : $("#frmWrite #apprv_idx").val()
									, "mappingApprvIdx" : apprvIdx 
									}
								,dataType: "json"
								,success: function(data) {
									console.log(data);
									if(data.result == 1) {
										fnc_toastMsgForResult("처리되었습니다.");
										 
										window.location.reload();	//새로고침
										
									} else {
										fnc_toastMsgForWarning(data.resultMsg);
										return false;
									}
								}
								,error: function(responseJSON, status, err) {
									fnc_toastMsgForWarning(err);
									return false;
								}
							});
							
							
						}
					});
				}
				
				//조회창 열기
				$(document).on("click", "#btnMapping", function(){
					$("#mappingDocModal").modal('show');	
					fnc_getMappingList(1);
				});
				
				
				//검색 조회
				$("#btnMappingSearch").on("click", function(){
					search();						
				});
				
				
				//문서 매핑정보 클릭 
				$(document).on("click", "#mappingTbody > tr > td > button", function(){
					mapping($(this).data("idx"));
					
				});
				
				
				mappingInit();
				
				
			}
			
			
		
			//공통 이벤트 
			ApprvSet.prototype.Event_Common = function(){
				
				$("#btnList").on("click", function(){
					fnc_List();	
				});
				
				
				//override validate 
				$("#frmWrite").validate({	
					errorPlacement: function(error, element) {
						$(element).eq(0).focus();
					},
					highlight: function(element, errorClass, validClass) {
						$(element).addClass('error').removeClass(validClass);
					}
				});
				
				
				//override validate 
				$("#frmModal1").validate({	
					errorPlacement: function(error, element) {
						// do nothing
					},
					highlight: function(element, errorClass, validClass) {
						$(element).addClass('error').removeClass(validClass);
					}
				});
				
				
				//override validate 
				$("#frmModal2").validate({	
					errorPlacement: function(error, element) {
						// do nothing
					},
					highlight: function(element, errorClass, validClass) {
						$(element).addClass('error').removeClass(validClass);
					}
				});
				
				//override validate 
				$("#frmModal3").validate({	
					errorPlacement: function(error, element) {
						// do nothing
					},
					highlight: function(element, errorClass, validClass) {
						$(element).addClass('error').removeClass(validClass);
					}
				});
				
				
				/** Bootstrap Tooltip **/ 
				jQuery("[data-toggle=tooltip]").tooltip();
				
				
			}
			
			
			
			
			//화면 구성 
			var pathCd = (location.pathname).split("/")[2];
			var _apprv = new ApprvSet();
			
			$(document).ready(function() {
				if(pathCd == _apprv.docLocation.get('writePage')) _apprv.Header_Write();
				else if(pathCd == _apprv.docLocation.get('approvalPage')) _apprv.Header_Approval();
				
				_apprv.approvalLineSet();	//결재자 생성 이벤트
				_apprv.dstrbLineSet();		//수신자 생성 이벤트
				_apprv.referLineSet();		//참조자 생성 이벤트
				_apprv.multiFileSet();	//첨부문서 설정 이벤트
				_apprv.mappingSet();	//기존문서 매핑 이벤트
				_apprv.docSet();		//결재문서 첨부 이벤트
				
				//결재문서타입별 화면 로드	
				document.getElementById("docArea").innerHTML = apprvDoc.PageHtml;
				apprvDoc.BaseDataSet("INSERT");	//기본데이터 설정 (수정화면, 조회화면 구분  INSERT/VIEW)
				apprvDoc.EventSet();
				
				if(pathCd == _apprv.docLocation.get('writePage')) _apprv.Event_Write();
				else if(pathCd == _apprv.docLocation.get('approvalPage')) _apprv.Event_Approval();
				
				_apprv.Event_Common();	
				
			});
			
			
			
			//목록 
			function fnc_List(){
				if(pathCd == _apprv.docLocation.get('writePage')){
					$("#frmList").attr("action", "/apprv/apply/index");
					
				}else if(pathCd == _apprv.docLocation.get('approvalPage')){
					//페이지 이동경로 설정
					$("#frmList #status_cd").val(_apprv.apprvAct.get("wait"));
					$("#frmList").attr("action", "/apprv/exec/index");
					
				}
				
				$("#frmList").submit();
			}
			
		
			
			// 유효성 검사
			function fnc_isValidInput(){
				var returnValue = true;
				var status_cd = $("#frmWrite #status_cd").val();
				
				//임시저장도 유효성 규칙을 따른다.
				if(status_cd != _apprv.apprvStatus.get('temp')){
					
					if( $("#divApproval #ldap_id").length < 2 ){
						fnc_toastMsgForWarning("지정된 결재자가 없습니다.");
						$("#divApproval").addClass("error");
						returnValue = false;
						return false;
						
					}
					
					returnValue = $("#frmWrite").valid();
					
					/*
					if(returnValue){	//결재, 합의관련 유효성 검사 추가
						var approvalCnt = 0;	//총 결재 인원
						var lastChrgCd = "";	//마지막 결재자 역할
						var totalChrgCd = $("#divApproval #chrgCd").length;
						
						$("#divApproval #chrgCd").each(function(index){
							if($(this).val() == 'SC002') approvalCnt++;
							if(index + 1 == totalChrgCd) lastChrgCd = $(this).val();
						});
						
						if(approvalCnt < 1){
							fnc_toastMsgForWarning("결재자는 최소 1명 이상이어야 합니다.");
							returnValue = false;
							return false;
						}
						
						
						if(lastChrgCd != 'SC002'){
							fnc_toastMsgForWarning("합의자와 승인자는 결재라인의 마지막이 될 수 없습니다.");
							returnValue = false;
							return false;
						
					}
					}
					*/
				}
				
				//각 결재문서 종류별 유효성 검사
				if(returnValue){
					returnValue = apprvDoc.Validate();
				}
		
		
				//파일 총 용량 제한(90MB)
				var allowSize = 90 * 1024 * 1024;
				var totalSize = 0;
				$("input[id=filesize]").each(function(){
					totalSize += Number($(this).val());
				});
				
				if(allowSize < totalSize) {
					fnc_toastMsgForWarning("최대 90MB까지만 첨부할 수 있습니다.");
					returnValue = false;
					return false;
				}
				
				return returnValue;
				
			}
				
				
			//자료다운로드
			function fnc_fileDownload(seq) {
				if(seq == 0){
					fnc_toastMsgForWarning("문서저장이후 다운로드 가능합니다.");
					return;
					
				}else{
					$("#frmFileDL #seq").val(seq);
					$("#frmFileDL").attr("action", "/apprv/apply/fileDownload").submit();
					
				}
			}
		
		
			// (결재문서 참조) > 결재문서 목록 조회 _ 페이징 포함 
			function fnc_getDocList(page){
				$('#docFrm #page').val(page);
				var param = $('#docFrm').serializeArray();
				$.post('/apprv/apply/ajaxGetApprvDocList',param ,function(data){
					$('#docModalBody').html(data);
				});
			}
			
			// (문서 매핑) > 결재문서 목록 조회 _ 페이징 포함 
			function fnc_getMappingList(page){
				$('#mappingFrm #page').val(page);
				var param = $('#mappingFrm').serializeArray();
				$.post('/apprv/apply/ajaxGetApprvMappingList',param ,function(data){
					$('#mappingModalBody').html(data);
				});
			}
		
		
			// 페이징
			/* function fnc_pageMoveDoc(page){
				$('#docFrm #page').val(page);
				fnc_getDocList();
			} */
			
			
			
			/* function fnc_pageMoveMapping(page){
				$('#mappingFrm #page').val(page);
				fnc_getMappingList();
			} */
			
			
		
		
			// 검색
			/*
			function fnc_search(){
				var date_pattern = /[0-9]{4}-[0-9]{2}-[0-9]{2}/;
		
				// 날짜 패턴 체크
				if($('#startDt').val() != ''){
					if(date_pattern.test($("#startDt").val()) == false){
						$("#startDt").addClass("error");
						$("#startDt").focus();
						fnc_toastMsgForWarning("날짜형식을 확인해 주세요 ex)2020-10-29");
						return false;
					}
					$("#startDt").removeClass("error");
				}
				
				if($('#endDt').val() != ''){
					if(date_pattern.test($("#endDt").val()) == false){
						$("#endDt").addClass("error");
						$("#endDt").focus();
						fnc_toastMsgForWarning("날짜형식을 확인해 주세요 ex)2020-10-29");
						return false;
					}
					$("#endDt").removeClass("error");
				}
		
				//$('#page').val(1);
				fnc_getDocList(1);
			}
			*/
		
		
			// 결재문서 추가
			/*
			function fnc_addDoc(obj){
		
				var str = '<button type="button" class="btn btn-sm btn-default" onclick="fnc_removeDoc($(this))">삭제</button>';
				
				var cloneTr = obj.closest('tr').clone();
				cloneTr.find('#btnTd').html(str);		
		
				$('#docModalTBody').append(cloneTr);
			}
			*/
		
		
			// 선택된 결재문서 삭제
			/*
			function fnc_removeDoc(obj){
				obj.closest('tr').remove();		
			}
			*/
			
		
		
			// 선택된 결재문서 보내기
			/*
			function fnc_sendDoc(){
				
				if($('#docModalTBody').html() == ''){
					fnc_toastMsgForWarning("선택된 결제문서가 없습니다.");
					return false;
				}
				
				// 문서 div
				var str = `
					<div data-idx="XXIDX" data-cd="XXCD" id="docDiv" class="alert alert-mini alert-default inline-block margin-top-10 margin-bottom-0"><!-- file-register -->
						<button type="button" class="close margin-left-20" data-dismiss="alert">
							<span aria-hidden="true">×</span>
							<span class="sr-only">삭제</span>
						</button>
						<a href="javascript:fnc_popupApprvDoc('XXIDX', 'XXCD');"><span>XXTITLE</span></a>
					</div>
				`
		
				// 결재문서 첨부 영역에 추가
				$('#docModalTBody').children().each(function(){
					var idx = $(this).data('idx');
					var docCd = $(this).data('cd');
					var title = $(this).find('#docTitle').text();
		
					var _str = str;
					_str = _str.replace(/XXIDX/gi, idx);
					_str = _str.replace(/XXCD/gi, docCd);
					_str = _str.replace(/XXTITLE/gi, title);
		
					
					// 문서 중복 체크
					if($('div[id=docDiv]').length == 0){
						$('#docDivArea').append(_str);
					}else{
						var a = []
						$('div[id=docDiv]').each(function(){
							a.push($(this).data('idx')) 
						});
						
						if(a.indexOf(idx) == -1){
							$('#docDivArea').append(_str);
						}
					}
					
						
				});
		
		
				// 모달 닫기
				$('#addDocModal').modal('hide');
		
				// 선택된 결재문서 내역 초기화
				$('#docModalTBody').html('');
				
			}
			*/
			
			
			
			//결재문서 팝업 보기
			function fnc_popupApprvDoc(apprv_idx, docCd){
				if(apprv_idx == "" || docCd == ""){
					fnc_toastMsgForWarning("결재문서를 불러올 수 있는 정보가 누락되었습니다.");
					return false;
					
				}else{
					var url = "/apprv/apply/popupPrintForm?apprv_idx=" + apprv_idx + "&docCd=" + docCd;
					var popupOpen = "scrollbars=yes,toolbar=no,resizable=no,width=1000,height=950,left=0,top=0";
					window.open(url,"printPage", popupOpen);
					
				}
				
			}
		
		
			
		</script>
		
					</div>
	</section>
	<!-- // middle -->
</div>
<!-- // wrapper -->

</body>
</html>